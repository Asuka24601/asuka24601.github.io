import{_ as le}from"./preload-helper-BXl3LOEh.js";import{R as oe}from"./__manifest-LTtVKofP.js";var y;function T(t,i,e){const n=typeof e,s=typeof t;if(n!=="undefined"){if(s!=="undefined"){if(e){if(s==="function"&&n===s)return function(o){return t(e(o))};if(i=t.constructor,i===e.constructor){if(i===Array)return e.concat(t);if(i===Map){var r=new Map(e);for(var h of t)r.set(h[0],h[1]);return r}if(i===Set){h=new Set(e);for(r of t.values())h.add(r);return h}}}return t}return e}return s==="undefined"?i:t}function U(t,i){return typeof t>"u"?i:t}function I(){return Object.create(null)}function N(t){return typeof t=="string"}function lt(t){return typeof t=="object"}function ot(t,i){if(N(i))t=t[i];else for(let e=0;t&&e<i.length;e++)t=t[i[e]];return t}const fe=/[^\p{L}\p{N}]+/u,ue=/(\d{3})/g,ce=/(\D)(\d{3})/g,ge=/(\d{3})(\D)/g,Ht=/[\u0300-\u036f]/g;function ft(t={}){if(!this||this.constructor!==ft)return new ft(...arguments);if(arguments.length)for(t=0;t<arguments.length;t++)this.assign(arguments[t]);else this.assign(t)}y=ft.prototype;y.assign=function(t){this.normalize=T(t.normalize,!0,this.normalize);let i=t.include,e=i||t.exclude||t.split,n;if(e||e===""){if(typeof e=="object"&&e.constructor!==RegExp){let s="";n=!i,i||(s+="\\p{Z}"),e.letter&&(s+="\\p{L}"),e.number&&(s+="\\p{N}",n=!!i),e.symbol&&(s+="\\p{S}"),e.punctuation&&(s+="\\p{P}"),e.control&&(s+="\\p{C}"),(e=e.char)&&(s+=typeof e=="object"?e.join(""):e);try{this.split=new RegExp("["+(i?"^":"")+s+"]+","u")}catch{this.split=/\s+/}}else this.split=e,n=e===!1||"a1a".split(e).length<2;this.numeric=T(t.numeric,n)}else{try{this.split=T(this.split,fe)}catch{this.split=/\s+/}this.numeric=T(t.numeric,T(this.numeric,!0))}if(this.prepare=T(t.prepare,null,this.prepare),this.finalize=T(t.finalize,null,this.finalize),e=t.filter,this.filter=typeof e=="function"?e:T(e&&new Set(e),null,this.filter),this.dedupe=T(t.dedupe,!0,this.dedupe),this.matcher=T((e=t.matcher)&&new Map(e),null,this.matcher),this.mapper=T((e=t.mapper)&&new Map(e),null,this.mapper),this.stemmer=T((e=t.stemmer)&&new Map(e),null,this.stemmer),this.replacer=T(t.replacer,null,this.replacer),this.minlength=T(t.minlength,1,this.minlength),this.maxlength=T(t.maxlength,1024,this.maxlength),this.rtl=T(t.rtl,!1,this.rtl),(this.cache=e=T(t.cache,!0,this.cache))&&(this.F=null,this.L=typeof e=="number"?e:2e5,this.B=new Map,this.D=new Map,this.I=this.H=128),this.h="",this.J=null,this.A="",this.K=null,this.matcher)for(const s of this.matcher.keys())this.h+=(this.h?"|":"")+s;if(this.stemmer)for(const s of this.stemmer.keys())this.A+=(this.A?"|":"")+s;return this};y.addStemmer=function(t,i){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(t,i),this.A+=(this.A?"|":"")+t,this.K=null,this.cache&&F(this),this};y.addFilter=function(t){return typeof t=="function"?this.filter=t:(this.filter||(this.filter=new Set),this.filter.add(t)),this.cache&&F(this),this};y.addMapper=function(t,i){return typeof t=="object"?this.addReplacer(t,i):t.length>1?this.addMatcher(t,i):(this.mapper||(this.mapper=new Map),this.mapper.set(t,i),this.cache&&F(this),this)};y.addMatcher=function(t,i){return typeof t=="object"?this.addReplacer(t,i):t.length<2&&(this.dedupe||this.mapper)?this.addMapper(t,i):(this.matcher||(this.matcher=new Map),this.matcher.set(t,i),this.h+=(this.h?"|":"")+t,this.J=null,this.cache&&F(this),this)};y.addReplacer=function(t,i){return typeof t=="string"?this.addMatcher(t,i):(this.replacer||(this.replacer=[]),this.replacer.push(t,i),this.cache&&F(this),this)};y.encode=function(t,i){if(this.cache&&t.length<=this.H)if(this.F){if(this.B.has(t))return this.B.get(t)}else this.F=setTimeout(F,50,this);this.normalize&&(typeof this.normalize=="function"?t=this.normalize(t):t=Ht?t.normalize("NFKD").replace(Ht,"").toLowerCase():t.toLowerCase()),this.prepare&&(t=this.prepare(t)),this.numeric&&t.length>3&&(t=t.replace(ce,"$1 $2").replace(ge,"$1 $2").replace(ue,"$1 "));const e=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let n=[],s=I(),r,h,o=this.split||this.split===""?t.split(this.split):[t];for(let f=0,u,c;f<o.length;f++)if((u=c=o[f])&&!(u.length<this.minlength||u.length>this.maxlength)){if(i){if(s[u])continue;s[u]=1}else{if(r===u)continue;r=u}if(e)n.push(u);else if(!this.filter||(typeof this.filter=="function"?this.filter(u):!this.filter.has(u))){if(this.cache&&u.length<=this.I)if(this.F){var l=this.D.get(u);if(l||l===""){l&&n.push(l);continue}}else this.F=setTimeout(F,50,this);if(this.stemmer){this.K||(this.K=new RegExp("(?!^)("+this.A+")$"));let d;for(;d!==u&&u.length>2;)d=u,u=u.replace(this.K,p=>this.stemmer.get(p))}if(u&&(this.mapper||this.dedupe&&u.length>1)){l="";for(let d=0,p="",m,g;d<u.length;d++)m=u.charAt(d),m===p&&this.dedupe||((g=this.mapper&&this.mapper.get(m))||g===""?g===p&&this.dedupe||!(p=g)||(l+=g):l+=p=m);u=l}if(this.matcher&&u.length>1&&(this.J||(this.J=new RegExp("("+this.h+")","g")),u=u.replace(this.J,d=>this.matcher.get(d))),u&&this.replacer)for(l=0;u&&l<this.replacer.length;l+=2)u=u.replace(this.replacer[l],this.replacer[l+1]);if(this.cache&&c.length<=this.I&&(this.D.set(c,u),this.D.size>this.L&&(this.D.clear(),this.I=this.I/1.1|0)),u){if(u!==c)if(i){if(s[u])continue;s[u]=1}else{if(h===u)continue;h=u}n.push(u)}}}return this.finalize&&(n=this.finalize(n)||n),this.cache&&t.length<=this.H&&(this.B.set(t,n),this.B.size>this.L&&(this.B.clear(),this.H=this.H/1.1|0)),n};function F(t){t.F=null,t.B.clear(),t.D.clear()}function It(t,i,e){e||(i||typeof t!="object"?typeof i=="object"&&(e=i,i=0):e=t),e&&(t=e.query||t,i=e.limit||i);let n=""+(i||0);e&&(n+=(e.offset||0)+!!e.context+!!e.suggest+(e.resolve!==!1)+(e.resolution||this.resolution)+(e.boost||0)),t=(""+t).toLowerCase(),this.cache||(this.cache=new G);let s=this.cache.get(t+n);if(!s){const r=e&&e.cache;r&&(e.cache=!1),s=this.search(t,i,e),r&&(e.cache=r),this.cache.set(t+n,s)}return s}function G(t){this.limit=t&&t!==!0?t:1e3,this.cache=new Map,this.h=""}G.prototype.set=function(t,i){this.cache.set(this.h=t,i),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)};G.prototype.get=function(t){const i=this.cache.get(t);return i&&this.h!==t&&(this.cache.delete(t),this.cache.set(this.h=t,i)),i};G.prototype.remove=function(t){for(const i of this.cache){const e=i[0];i[1].includes(t)&&this.cache.delete(e)}};G.prototype.clear=function(){this.cache.clear(),this.h=""};const Wt={normalize:!1,numeric:!1,dedupe:!1},pt={},St=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),Jt=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),Qt=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],Vt={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,ÃŸ:2,d:3,t:3,l:4,m:5,n:5,r:6};var Gt={Exact:Wt,Default:pt,Normalize:pt,LatinBalance:{mapper:St},LatinAdvanced:{mapper:St,matcher:Jt,replacer:Qt},LatinExtra:{mapper:St,replacer:Qt.concat([/(?!^)[aeo]/g,""]),matcher:Jt},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(t){for(let e=0;e<t.length;e++){var i=t[e];let n=i.charAt(0),s=Vt[n];for(let r=1,h;r<i.length&&(h=i.charAt(r),h==="h"||h==="w"||!(h=Vt[h])||h===s||(n+=h,s=h,n.length!==4));r++);t[e]=n}}},CJK:{split:""},LatinExact:Wt,LatinDefault:pt,LatinSimple:pt};function Zt(t,i,e,n){let s=[];for(let r=0,h;r<t.index.length;r++)if(h=t.index[r],i>=h.length)i-=h.length;else{i=h[n?"splice":"slice"](i,e);const o=i.length;if(o&&(s=s.length?s.concat(i):i,e-=o,n&&(t.length-=o),!e))break;i=0}return s}function it(t){if(!this||this.constructor!==it)return new it(t);this.index=t?[t]:[],this.length=t?t.length:0;const i=this;return new Proxy([],{get(e,n){if(n==="length")return i.length;if(n==="push")return function(s){i.index[i.index.length-1].push(s),i.length++};if(n==="pop")return function(){if(i.length)return i.length--,i.index[i.index.length-1].pop()};if(n==="indexOf")return function(s){let r=0;for(let h=0,o,l;h<i.index.length;h++){if(o=i.index[h],l=o.indexOf(s),l>=0)return r+l;r+=o.length}return-1};if(n==="includes")return function(s){for(let r=0;r<i.index.length;r++)if(i.index[r].includes(s))return!0;return!1};if(n==="slice")return function(s,r){return Zt(i,s||0,r||i.length,!1)};if(n==="splice")return function(s,r){return Zt(i,s||0,r||i.length,!0)};if(n==="constructor")return Array;if(typeof n!="symbol")return(e=i.index[n/2**31|0])&&e[n]},set(e,n,s){return e=n/2**31|0,(i.index[e]||(i.index[e]=[]))[n]=s,i.length++,!0}})}it.prototype.clear=function(){this.index.length=0};it.prototype.push=function(){};function H(t=8){if(!this||this.constructor!==H)return new H(t);this.index=I(),this.h=[],this.size=0,t>32?(this.B=qt,this.A=BigInt(t)):(this.B=Ut,this.A=t)}H.prototype.get=function(t){const i=this.index[this.B(t)];return i&&i.get(t)};H.prototype.set=function(t,i){var e=this.B(t);let n=this.index[e];n?(e=n.size,n.set(t,i),(e-=n.size)&&this.size++):(this.index[e]=n=new Map([[t,i]]),this.h.push(n),this.size++)};function W(t=8){if(!this||this.constructor!==W)return new W(t);this.index=I(),this.h=[],this.size=0,t>32?(this.B=qt,this.A=BigInt(t)):(this.B=Ut,this.A=t)}W.prototype.add=function(t){var i=this.B(t);let e=this.index[i];e?(i=e.size,e.add(t),(i-=e.size)&&this.size++):(this.index[i]=e=new Set([t]),this.h.push(e),this.size++)};y=H.prototype;y.has=W.prototype.has=function(t){const i=this.index[this.B(t)];return i&&i.has(t)};y.delete=W.prototype.delete=function(t){const i=this.index[this.B(t)];i&&i.delete(t)&&this.size--};y.clear=W.prototype.clear=function(){this.index=I(),this.h=[],this.size=0};y.values=W.prototype.values=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].values())yield i};y.keys=W.prototype.keys=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].keys())yield i};y.entries=W.prototype.entries=function*(){for(let t=0;t<this.h.length;t++)for(let i of this.h[t].entries())yield i};function Ut(t){let i=2**this.A-1;if(typeof t=="number")return t&i;let e=0,n=this.A+1;for(let s=0;s<t.length;s++)e=(e*n^t.charCodeAt(s))&i;return this.A===32?e+2**31:e}function qt(t){let i=BigInt(2)**this.A-BigInt(1);var e=typeof t;if(e==="bigint")return t&i;if(e==="number")return BigInt(t)&i;e=BigInt(0);let n=this.A+BigInt(1);for(let s=0;s<t.length;s++)e=(e*n^BigInt(t.charCodeAt(s)))&i;return e}let q,ht;async function pe(t){t=t.data;var i=t.task;const e=t.id;let n=t.args;if(i==="init")ht=t.options||{},(i=t.factory)?(Function("return "+i)()(self),q=new self.FlexSearch.Index(ht),delete self.FlexSearch):q=new Q(ht),postMessage({id:e});else{let s;i==="export"&&(n[1]?(n[0]=ht.export,n[2]=0,n[3]=1):n=null),i==="import"?n[0]&&(t=await ht.import.call(q,n[0]),q.import(n[0],t)):((s=n&&q[i].apply(q,n))&&s.then&&(s=await s),s&&s.await&&(s=await s.await),i==="search"&&s.result&&(s=s.result)),postMessage(i==="search"?{id:e,msg:s}:{id:e})}}function Pt(t){tt.call(t,"add"),tt.call(t,"append"),tt.call(t,"search"),tt.call(t,"update"),tt.call(t,"remove"),tt.call(t,"searchCache")}let At,Lt,mt;function ae(){At=mt=0}function tt(t){this[t+"Async"]=function(){const i=arguments;var e=i[i.length-1];let n;if(typeof e=="function"&&(n=e,delete i[i.length-1]),At?mt||(mt=Date.now()-Lt>=this.priority*this.priority*3):(At=setTimeout(ae,0),Lt=Date.now()),mt){const r=this;return new Promise(h=>{setTimeout(function(){h(r[t+"Async"].apply(r,i))},0)})}const s=this[t].apply(this,i);return e=s.then?s:new Promise(r=>r(s)),n&&e.then(n),e}}let Z=0;function st(t={},i){function e(o){function l(f){f=f.data||f;const u=f.id,c=u&&r.h[u];c&&(c(f.msg),delete r.h[u])}if(this.worker=o,this.h=I(),this.worker)return s?this.worker.on("message",l):this.worker.onmessage=l,t.config?new Promise(function(f){Z>1e9&&(Z=0),r.h[++Z]=function(){f(r)},r.worker.postMessage({id:Z,task:"init",factory:n,options:t})}):(this.priority=t.priority||4,this.encoder=i||null,this.worker.postMessage({task:"init",factory:n,options:t}),this)}if(!this||this.constructor!==st)return new st(t);let n=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;n&&(n=n.toString());const s=typeof window>"u",r=this,h=de(n,s,t.worker);return h.then?h.then(function(o){return e.call(r,o)}):e.call(this,h)}L("add");L("append");L("search");L("update");L("remove");L("clear");L("export");L("import");st.prototype.searchCache=It;Pt(st.prototype);function L(t){st.prototype[t]=function(){const i=this,e=[].slice.call(arguments);var n=e[e.length-1];let s;return typeof n=="function"&&(s=n,e.pop()),n=new Promise(function(r){t==="export"&&typeof e[0]=="function"&&(e[0]=null),Z>1e9&&(Z=0),i.h[++Z]=r,i.worker.postMessage({task:t,id:Z,args:e})}),s?(n.then(s),this):n}}function de(t,i,e){return i?typeof module<"u"?new(require("worker_threads")).Worker(__dirname+"/worker/node.js"):le(()=>import("./__vite-browser-external-BIHI7g3E.js"),[]).then(function(n){return new n.Worker(import.meta.dirname+"/node/node.mjs")}):t?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+pe.toString()],{type:"text/javascript"}))):new window.Worker(typeof e=="string"?e:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js").replace("flexsearch.bundle.module.min.mjs","module/worker/worker.js"),{type:"module"})}E.prototype.add=function(t,i,e){if(lt(t)&&(i=t,t=ot(i,this.key)),i&&(t||t===0)){if(!e&&this.reg.has(t))return this.update(t,i);for(let o=0,l;o<this.field.length;o++){l=this.B[o];var n=this.index.get(this.field[o]);if(typeof l=="function"){var s=l(i);s&&n.add(t,s,e,!0)}else s=l.G,(!s||s(i))&&(l.constructor===String?l=[""+l]:N(l)&&(l=[l]),Bt(i,l,this.D,0,n,t,l[0],e))}if(this.tag)for(n=0;n<this.A.length;n++){var r=this.A[n];s=this.tag.get(this.F[n]);let o=I();if(typeof r=="function"){if(r=r(i),!r)continue}else{var h=r.G;if(h&&!h(i))continue;r.constructor===String&&(r=""+r),r=ot(i,r)}if(s&&r){N(r)&&(r=[r]);for(let l=0,f,u;l<r.length;l++)if(f=r[l],!o[f]&&(o[f]=1,(h=s.get(f))?u=h:s.set(f,u=[]),!e||!u.includes(t))){if(u.length===2**31-1){if(h=new it(u),this.fastupdate)for(let c of this.reg.values())c.includes(u)&&(c[c.indexOf(u)]=h);s.set(f,u=h)}u.push(t),this.fastupdate&&((h=this.reg.get(t))?h.push(u):this.reg.set(t,[u]))}}}if(this.store&&(!e||!this.store.has(t))){let o;if(this.h){o=I();for(let l=0,f;l<this.h.length;l++){if(f=this.h[l],(e=f.G)&&!e(i))continue;let u;if(typeof f=="function"){if(u=f(i),!u)continue;f=[f.O]}else if(N(f)||f.constructor===String){o[f]=i[f];continue}zt(i,o,f,0,f[0],u)}}this.store.set(t,o||i)}this.worker&&(this.fastupdate||this.reg.add(t))}return this};function zt(t,i,e,n,s,r){if(t=t[s],n===e.length-1)i[s]=r||t;else if(t)if(t.constructor===Array)for(i=i[s]=Array(t.length),s=0;s<t.length;s++)zt(t,i,e,n,s);else i=i[s]||(i[s]=I()),s=e[++n],zt(t,i,e,n,s)}function Bt(t,i,e,n,s,r,h,o){if(t=t[h])if(n===i.length-1){if(t.constructor===Array){if(e[n]){for(i=0;i<t.length;i++)s.add(r,t[i],!0,!0);return}t=t.join(" ")}s.add(r,t,o,!0)}else if(t.constructor===Array)for(h=0;h<t.length;h++)Bt(t,i,e,n,s,r,h,o);else h=i[++n],Bt(t,i,e,n,s,r,h,o)}function Rt(t,i,e,n){if(!t.length)return t;if(t.length===1)return t=t[0],t=e||t.length>i?t.slice(e,e+i):t,n?et.call(this,t):t;let s=[];for(let r=0,h,o;r<t.length;r++)if((h=t[r])&&(o=h.length)){if(e){if(e>=o){e-=o;continue}h=h.slice(e,e+i),o=h.length,e=0}if(o>i&&(h=h.slice(0,i),o=i),!s.length&&o>=i)return n?et.call(this,h):h;if(s.push(h),i-=o,!i)break}return s=s.length>1?[].concat.apply([],s):s[0],n?et.call(this,s):s}function bt(t,i,e,n){var s=n[0];if(s[0]&&s[0].query)return t[i].apply(t,s);if(!(i!=="and"&&i!=="not"||t.result.length||t.await||s.suggest))return n.length>1&&(s=n[n.length-1]),(n=s.resolve)?t.await||t.result:t;let r=[],h=0,o=0,l,f,u,c,d;for(i=0;i<n.length;i++)if(s=n[i]){var p=void 0;if(s.constructor===B)p=s.await||s.result;else if(s.then||s.constructor===Array)p=s;else{h=s.limit||0,o=s.offset||0,u=s.suggest,f=s.resolve,l=((c=s.highlight||t.highlight)||s.enrich)&&f,p=s.queue;let m=s.async||p,g=s.index,a=s.query;if(g?t.index||(t.index=g):g=t.index,a||s.tag){const x=s.field||s.pluck;if(x&&(!a||t.query&&!c||(t.query=a,t.field=x,t.highlight=c),g=g.index.get(x)),p&&(d||t.await)){d=1;let w;const b=t.C.length,_=new Promise(function(A){w=A});(function(A,S){_.h=function(){S.index=null,S.resolve=!1;let M=m?A.searchAsync(S):A.search(S);return M.then?M.then(function(k){return t.C[b]=k=k.result||k,w(k),k}):(M=M.result||M,w(M),M)}})(g,Object.assign({},s)),t.C.push(_),r[i]=_;continue}else s.resolve=!1,s.index=null,p=m?g.searchAsync(s):g.search(s),s.resolve=f,s.index=g}else if(s.and)p=at(s,"and",g);else if(s.or)p=at(s,"or",g);else if(s.not)p=at(s,"not",g);else if(s.xor)p=at(s,"xor",g);else continue}p.await?(d=1,p=p.await):p.then?(d=1,p=p.then(function(m){return m.result||m})):p=p.result||p,r[i]=p}if(d&&!t.await&&(t.await=new Promise(function(m){t.return=m})),d){const m=Promise.all(r).then(function(g){for(let a=0;a<t.C.length;a++)if(t.C[a]===m){t.C[a]=function(){return e.call(t,g,h,o,l,f,u,c)};break}Tt(t)});t.C.push(m)}else if(t.await)t.C.push(function(){return e.call(t,r,h,o,l,f,u,c)});else return e.call(t,r,h,o,l,f,u,c);return f?t.await||t.result:t}function at(t,i,e){t=t[i];const n=t[0]||t;return n.index||(n.index=e),e=new B(n),t.length>1&&(e=e[i].apply(e,t.slice(1))),e}B.prototype.or=function(){return bt(this,"or",me,arguments)};function me(t,i,e,n,s,r,h){return t.length&&(this.result.length&&t.push(this.result),t.length<2?this.result=t[0]:(this.result=te(t,i,e,!1,this.h),e=0)),s&&(this.await=null),s?this.resolve(i,e,n,h):this}B.prototype.and=function(){return bt(this,"and",we,arguments)};function we(t,i,e,n,s,r,h){if(!r&&!this.result.length)return s?this.result:this;let o;if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{let l=0;for(let f=0,u,c;f<t.length;f++)if((u=t[f])&&(c=u.length))l<c&&(l=c);else if(!r){l=0;break}l?(this.result=yt(t,l,i,e,r,this.h,s),o=!0):this.result=[]}else r||(this.result=t);return s&&(this.await=null),s?this.resolve(i,e,n,h,o):this}B.prototype.xor=function(){return bt(this,"xor",ye,arguments)};function ye(t,i,e,n,s,r,h){if(t.length)if(this.result.length&&t.unshift(this.result),t.length<2)this.result=t[0];else{t:{r=e;var o=this.h;const l=[],f=I();let u=0;for(let c=0,d;c<t.length;c++)if(d=t[c]){u<d.length&&(u=d.length);for(let p=0,m;p<d.length;p++)if(m=d[p])for(let g=0,a;g<m.length;g++)a=m[g],f[a]=f[a]?2:1}for(let c=0,d,p=0;c<u;c++)for(let m=0,g;m<t.length;m++)if((g=t[m])&&(d=g[c])){for(let a=0,x;a<d.length;a++)if(x=d[a],f[x]===1)if(r)r--;else if(s){if(l.push(x),l.length===i){t=l;break t}}else{const w=c+(m?o:0);if(l[w]||(l[w]=[]),l[w].push(x),++p===i){t=l;break t}}}t=l}this.result=t,o=!0}else r||(this.result=t);return s&&(this.await=null),s?this.resolve(i,e,n,h,o):this}B.prototype.not=function(){return bt(this,"not",xe,arguments)};function xe(t,i,e,n,s,r,h){if(!r&&!this.result.length)return s?this.result:this;if(t.length&&this.result.length){t:{r=e;var o=[];t=new Set(t.flat().flat());for(let l=0,f,u=0;l<this.result.length;l++)if(f=this.result[l]){for(let c=0,d;c<f.length;c++)if(d=f[c],!t.has(d)){if(r)r--;else if(s){if(o.push(d),o.length===i){t=o;break t}}else if(o[l]||(o[l]=[]),o[l].push(d),++u===i){t=o;break t}}}t=o}this.result=t,o=!0}return s&&(this.await=null),s?this.resolve(i,e,n,h,o):this}function wt(t,i,e,n,s){let r,h,o;typeof s=="string"?(r=s,s=""):r=s.template,h=r.indexOf("$1"),o=r.substring(h+2),h=r.substring(0,h);let l=s&&s.boundary,f=!s||s.clip!==!1,u=s&&s.merge&&o&&h&&new RegExp(o+" "+h,"g");s=s&&s.ellipsis;var c=0;if(typeof s=="object"){var d=s.template;c=d.length-2,s=s.pattern}typeof s!="string"&&(s=s===!1?"":"..."),c&&(s=d.replace("$1",s)),d=s.length-c;let p,m;typeof l=="object"&&(p=l.before,p===0&&(p=-1),m=l.after,m===0&&(m=-1),l=l.total||9e5),c=new Map;for(let Mt=0,Y,Nt,nt;Mt<i.length;Mt++){let rt;if(n)rt=i,nt=n;else{var g=i[Mt];if(nt=g.field,!nt)continue;rt=g.result}Nt=e.get(nt),Y=Nt.encoder,g=c.get(Y),typeof g!="string"&&(g=Y.encode(t),c.set(Y,g));for(let ct=0;ct<rt.length;ct++){var a=rt[ct].doc;if(!a||(a=ot(a,nt),!a))continue;var x=a.trim().split(/\s+/);if(!x.length)continue;a="";var w=[];let gt=[];for(var b=-1,_=-1,A=0,S=0;S<x.length;S++){var M=x[S],k=Y.encode(M);k=k.length>1?k.join(" "):k[0];let v;if(k&&M){for(var j=M.length,C=(Y.split?M.replace(Y.split,""):M).length-k.length,z="",R=0,$=0;$<g.length;$++){var K=g[$];if(K){var P=K.length;P+=C<0?0:C,R&&P<=R||(K=k.indexOf(K),K>-1&&(z=(K?M.substring(0,K):"")+h+M.substring(K,K+P)+o+(K+P<j?M.substring(K+P):""),R=P,v=!0))}}z&&(l&&(b<0&&(b=a.length+(a?1:0)),_=a.length+(a?1:0)+z.length,A+=j,gt.push(w.length),w.push({match:z})),a+=(a?" ":"")+z)}if(!v)M=x[S],a+=(a?" ":"")+M,l&&w.push({text:M});else if(l&&A>=l)break}if(A=gt.length*(r.length-2),p||m||l&&a.length-A>l)if(A=l+A-d*2,S=_-b,p>0&&(S+=p),m>0&&(S+=m),S<=A)x=p?b-(p>0?p:0):b-((A-S)/2|0),w=m?_+(m>0?m:0):x+A,f||(x>0&&a.charAt(x)!==" "&&a.charAt(x-1)!==" "&&(x=a.indexOf(" ",x),x<0&&(x=0)),w<a.length&&a.charAt(w-1)!==" "&&a.charAt(w)!==" "&&(w=a.lastIndexOf(" ",w),w<_?w=_:++w)),a=(x?s:"")+a.substring(x,w)+(w<a.length?s:"");else{for(_=[],b={},A={},S={},M={},k={},z=C=j=0,$=R=1;;){var J=void 0;for(let v=0,O;v<gt.length;v++){if(O=gt[v],z)if(C!==z){if(S[v+1])continue;if(O+=z,b[O]){j-=d,A[v+1]=1,S[v+1]=1;continue}if(O>=w.length-1){if(O>=w.length){S[v+1]=1,O>=x.length&&(A[v+1]=1);continue}j-=d}if(a=w[O].text,P=m&&k[v])if(P>0){if(a.length>P)if(S[v+1]=1,f)a=a.substring(0,P);else continue;(P-=a.length)||(P=-1),k[v]=P}else{S[v+1]=1;continue}if(j+a.length+1<=l)a=" "+a,_[v]+=a;else if(f)J=l-j-1,J>0&&(a=" "+a.substring(0,J),_[v]+=a),S[v+1]=1;else{S[v+1]=1;continue}}else{if(S[v])continue;if(O-=C,b[O]){j-=d,S[v]=1,A[v]=1;continue}if(O<=0){if(O<0){S[v]=1,A[v]=1;continue}j-=d}if(a=w[O].text,P=p&&M[v])if(P>0){if(a.length>P)if(S[v]=1,f)a=a.substring(a.length-P);else continue;(P-=a.length)||(P=-1),M[v]=P}else{S[v]=1;continue}if(j+a.length+1<=l)a+=" ",_[v]=a+_[v];else if(f)J=a.length+1-(l-j),J>=0&&J<a.length&&(a=a.substring(J)+" ",_[v]=a+_[v]),S[v]=1;else{S[v]=1;continue}}else{a=w[O].match,p&&(M[v]=p),m&&(k[v]=m),v&&j++;let jt;if(O?!v&&d&&(j+=d):(A[v]=1,S[v]=1),O>=x.length-1||O<w.length-1&&w[O+1].match?jt=1:d&&(j+=d),j-=r.length-2,!v||j+a.length<=l)_[v]=a;else{J=R=$=A[v]=0;break}jt&&(A[v+1]=1,S[v+1]=1)}j+=a.length,J=b[O]=1}if(J)C===z?z++:C++;else{if(C===z?R=0:$=0,!R&&!$)break;R?(C++,z=C):z++}}a="";for(let v=0,O;v<_.length;v++)O=(A[v]?v?" ":"":(v&&!s?" ":"")+s)+_[v],a+=O;s&&!A[_.length]&&(a+=s)}u&&(a=a.replace(u," ")),rt[ct].highlight=a}if(n)break}return i}function B(t,i){if(!this||this.constructor!==B)return new B(t,i);let e=0,n,s,r,h,o,l;if(t&&t.index){const f=t;if(i=f.index,e=f.boost||0,s=f.query){r=f.field||f.pluck,h=f.highlight;const u=f.resolve;t=f.async||f.queue,f.resolve=!1,f.index=null,t=t?i.searchAsync(f):i.search(f),f.resolve=u,f.index=i,t=t.result||t}else t=[]}if(t&&t.then){const f=this;t=t.then(function(u){f.C[0]=f.result=u.result||u,Tt(f)}),n=[t],t=[],o=new Promise(function(u){l=u})}this.index=i||null,this.result=t||[],this.h=e,this.C=n||[],this.await=o||null,this.return=l||null,this.highlight=h||null,this.query=s||"",this.field=r||""}y=B.prototype;y.limit=function(t){if(this.await){const i=this;this.C.push(function(){return i.limit(t).result})}else if(this.result.length){const i=[];for(let e=0,n;e<this.result.length;e++)if(n=this.result[e])if(n.length<=t){if(i[e]=n,t-=n.length,!t)break}else{i[e]=n.slice(0,t);break}this.result=i}return this};y.offset=function(t){if(this.await){const i=this;this.C.push(function(){return i.offset(t).result})}else if(this.result.length){const i=[];for(let e=0,n;e<this.result.length;e++)(n=this.result[e])&&(n.length<=t?t-=n.length:(i[e]=n.slice(t),t=0));this.result=i}return this};y.boost=function(t){if(this.await){const i=this;this.C.push(function(){return i.boost(t).result})}else this.h+=t;return this};function Tt(t,i){let e=t.result;var n=t.await;t.await=null;for(let s=0,r;s<t.C.length;s++)if(r=t.C[s]){if(typeof r=="function")e=r(),t.C[s]=e=e.result||e,s--;else if(r.h)e=r.h(),t.C[s]=e=e.result||e,s--;else if(r.then)return t.await=n}return n=t.return,t.C=[],t.return=null,i||n(e),e}y.resolve=function(t,i,e,n,s){let r=this.await?Tt(this,!0):this.result;if(r.then){const h=this;return r.then(function(){return h.resolve(t,i,e,n,s)})}return r.length&&(typeof t=="object"?(n=t.highlight||this.highlight,e=!!n||t.enrich,i=t.offset,t=t.limit):(n=n||this.highlight,e=!!n||e),r=s?e?et.call(this.index,r):r:Rt.call(this.index,r,t||100,i,e)),this.finalize(r,n)};y.finalize=function(t,i){if(t.then){const n=this;return t.then(function(s){return n.finalize(s,i)})}i&&t.length&&this.query&&(t=wt(this.query,t,this.index.index,this.field,i));const e=this.return;return this.highlight=this.index=this.result=this.C=this.await=this.return=null,this.query=this.field="",e&&e(t),t};function yt(t,i,e,n,s,r,h){const o=t.length;let l=[],f,u;f=I();for(let c=0,d,p,m,g;c<i;c++)for(let a=0;a<o;a++)if(m=t[a],c<m.length&&(d=m[c]))for(let x=0;x<d.length;x++){if(p=d[x],(u=f[p])?f[p]++:(u=0,f[p]=1),g=l[u]||(l[u]=[]),!h){let w=c+(a||!s?0:r||0);g=g[w]||(g[w]=[])}if(g.push(p),h&&e&&u===o-1&&g.length-n===e)return n?g.slice(n):g}if(t=l.length)if(s)l=l.length>1?te(l,e,n,h,r):(l=l[0])&&e&&l.length>e||n?l.slice(n,e+n):l;else{if(t<o)return[];if(l=l[t-1],e||n)if(h)(l.length>e||n)&&(l=l.slice(n,e+n));else{s=[];for(let c=0,d;c<l.length;c++)if(d=l[c]){if(n&&d.length>n)n-=d.length;else if((e&&d.length>e||n)&&(d=d.slice(n,e+n),e-=d.length,n&&(n-=d.length)),s.push(d),!e)break}l=s}}return l}function te(t,i,e,n,s){const r=[],h=I();let o;var l=t.length;let f;if(n){for(s=l-1;s>=0;s--)if(f=(n=t[s])&&n.length){for(l=0;l<f;l++)if(o=n[l],!h[o]){if(h[o]=1,e)e--;else if(r.push(o),r.length===i)return r}}}else for(let u=l-1,c,d=0;u>=0;u--){c=t[u];for(let p=0;p<c.length;p++)if(f=(n=c[p])&&n.length){for(let m=0;m<f;m++)if(o=n[m],!h[o])if(h[o]=1,e)e--;else{let g=(p+(u<l-1&&s||0))/(u+1)|0;if((r[g]||(r[g]=[])).push(o),++d===i)return r}}}return r}function ke(t,i,e,n,s){const r=I(),h=[];for(let o=0,l;o<i.length;o++){l=i[o];for(let f=0;f<l.length;f++)r[l[f]]=1}if(s){for(let o=0,l;o<t.length;o++)if(l=t[o],r[l]){if(n)n--;else if(h.push(l),r[l]=0,e&&--e===0)break}}else for(let o=0,l,f;o<t.result.length;o++)for(l=t.result[o],i=0;i<l.length;i++)f=l[i],r[f]&&((h[o]||(h[o]=[])).push(f),r[f]=0);return h}E.prototype.search=function(t,i,e,n){e||(!i&&lt(t)?(e=t,t=""):lt(i)&&(e=i,i=0));let s=[];var r=[];let h,o,l,f,u,c,d=0,p=!0,m;if(e){e.constructor===Array&&(e={index:e}),t=e.query||t,h=e.pluck,o=e.merge,f=e.boost,c=h||e.field||(c=e.index)&&(c.index?null:c);var g=this.tag&&e.tag;l=e.suggest,p=e.resolve!==!1,u=e.cache,m=p&&this.store&&e.highlight;var a=!!m||p&&this.store&&e.enrich;i=e.limit||i;var x=e.offset||0;if(i||(i=p?100:0),g&&(!this.db||!n)){g.constructor!==Array&&(g=[g]);var w=[];for(let M=0,k;M<g.length;M++)if(k=g[M],k.field&&k.tag){var b=k.tag;if(b.constructor===Array)for(var _=0;_<b.length;_++)w.push(k.field,b[_]);else w.push(k.field,b)}else{b=Object.keys(k);for(let j=0,C,z;j<b.length;j++)if(C=b[j],z=k[C],z.constructor===Array)for(_=0;_<z.length;_++)w.push(C,z[_]);else w.push(C,z)}if(g=w,!t){if(r=[],w.length)for(g=0;g<w.length;g+=2){if(this.db){if(n=this.index.get(w[g]),!n)continue;r.push(n=n.db.tag(w[g+1],i,x,a))}else n=ve.call(this,w[g],w[g+1],i,x,a);s.push(p?{field:w[g],tag:w[g+1],result:n}:[n])}if(r.length){const M=this;return Promise.all(r).then(function(k){for(let j=0;j<k.length;j++)p?s[j].result=k[j]:s[j]=k[j];return p?s:new B(s.length>1?yt(s,1,0,0,l,f):s[0],M)})}return p?s:new B(s.length>1?yt(s,1,0,0,l,f):s[0],this)}}p||h||!(c=c||this.field)||(N(c)?h=c:(c.constructor===Array&&c.length===1&&(c=c[0]),h=c.field||c.index)),c&&c.constructor!==Array&&(c=[c])}c||(c=this.field);let A;w=(this.worker||this.db)&&!n&&[];for(let M=0,k,j,C;M<c.length;M++){if(j=c[M],this.db&&this.tag&&!this.B[M])continue;let z;if(N(j)||(z=j,j=z.field,t=z.query||t,i=U(z.limit,i),x=U(z.offset,x),l=U(z.suggest,l),m=p&&this.store&&U(z.highlight,m),a=!!m||p&&this.store&&U(z.enrich,a),u=U(z.cache,u)),n)k=n[M];else{b=z||e||{},_=b.enrich;var S=this.index.get(j);if(g&&(this.db&&(b.tag=g,b.field=c,A=S.db.support_tag_search),!A&&_&&(b.enrich=!1),A||(b.limit=0,b.offset=0)),k=u?S.searchCache(t,g&&!A?0:i,b):S.search(t,g&&!A?0:i,b),g&&!A&&(b.limit=i,b.offset=x),_&&(b.enrich=_),w){w[M]=k;continue}}if(C=(k=k.result||k)&&k.length,g&&C){if(b=[],_=0,this.db&&n){if(!A)for(S=c.length;S<n.length;S++){let R=n[S];if(R&&R.length)_++,b.push(R);else if(!l)return p?s:new B(s,this)}}else for(let R=0,$,K;R<g.length;R+=2){if($=this.tag.get(g[R]),!$){if(l)continue;return p?s:new B(s,this)}if(K=($=$&&$.get(g[R+1]))&&$.length)_++,b.push($);else if(!l)return p?s:new B(s,this)}if(_){if(k=ke(k,b,i,x,p),C=k.length,!C&&!l)return p?k:new B(k,this);_--}}if(C)r[d]=j,s.push(k),d++;else if(c.length===1)return p?s:new B(s,this)}if(w){if(this.db&&g&&g.length&&!A)for(a=0;a<g.length;a+=2){if(r=this.index.get(g[a]),!r){if(l)continue;return p?s:new B(s,this)}w.push(r.db.tag(g[a+1],i,x,!1))}const M=this;return Promise.all(w).then(function(k){return e&&(e.resolve=p),k.length&&(k=M.search(t,i,e,k)),k})}if(!d)return p?s:new B(s,this);if(h&&(!a||!this.store))return s=s[0],p?s:new B(s,this);for(w=[],x=0;x<r.length;x++){if(g=s[x],a&&g.length&&typeof g[0].doc>"u"&&(this.db?w.push(g=this.index.get(this.field[0]).db.enrich(g)):g=et.call(this,g)),h)return p?m?wt(t,g,this.index,h,m):g:new B(g,this);s[x]={field:r[x],result:g}}if(a&&this.db&&w.length){const M=this;return Promise.all(w).then(function(k){for(let j=0;j<k.length;j++)s[j].result=k[j];return m&&(s=wt(t,s,M.index,h,m)),o?Xt(s):s})}return m&&(s=wt(t,s,this.index,h,m)),o?Xt(s):s};function Xt(t){const i=[],e=I(),n=I();for(let s=0,r,h,o,l,f,u,c;s<t.length;s++){r=t[s],h=r.field,o=r.result;for(let d=0;d<o.length;d++)f=o[d],typeof f!="object"?f={id:l=f}:l=f.id,(u=e[l])?u.push(h):(f.field=e[l]=[h],i.push(f)),(c=f.highlight)&&(u=n[l],u||(n[l]=u={},f.highlight=u),u[h]=c)}return i}function ve(t,i,e,n,s){return t=this.tag.get(t),t?(t=t.get(i),t?(i=t.length-n,i>0&&((e&&i>e||n)&&(t=t.slice(n,n+e)),s&&(t=et.call(this,t))),t):[]):[]}function et(t){if(!this||!this.store)return t;if(this.db)return this.index.get(this.field[0]).db.enrich(t);const i=Array(t.length);for(let e=0,n;e<t.length;e++)n=t[e],i[e]={id:n,doc:this.store.get(n)};return i}function E(t){if(!this||this.constructor!==E)return new E(t);const i=t.document||t.doc||t;let e,n;if(this.B=[],this.field=[],this.D=[],this.key=(e=i.key||i.id)&&xt(e,this.D)||"id",(n=t.keystore||0)&&(this.keystore=n),this.fastupdate=!!t.fastupdate,this.reg=!this.fastupdate||t.worker||t.db?n?new W(n):new Set:n?new H(n):new Map,this.h=(e=i.store||null)&&e&&e!==!0&&[],this.store=e?n?new H(n):new Map:null,this.cache=(e=t.cache||null)&&new G(e),t.cache=!1,this.worker=t.worker||!1,this.priority=t.priority||4,this.index=be.call(this,t,i),this.tag=null,(e=i.tag)&&(typeof e=="string"&&(e=[e]),e.length)){this.tag=new Map,this.A=[],this.F=[];for(let s=0,r,h;s<e.length;s++){if(r=e[s],h=r.field||r,!h)throw Error("The tag field from the document descriptor is undefined.");r.custom?this.A[s]=r.custom:(this.A[s]=xt(h,this.D),r.filter&&(typeof this.A[s]=="string"&&(this.A[s]=new String(this.A[s])),this.A[s].G=r.filter)),this.F[s]=h,this.tag.set(h,new Map)}}if(this.worker){this.fastupdate=!1,t=[];for(const s of this.index.values())s.then&&t.push(s);if(t.length){const s=this;return Promise.all(t).then(function(r){let h=0;for(const o of s.index.entries()){const l=o[0];let f=o[1];f.then&&(f=r[h],s.index.set(l,f),h++)}return s})}}else t.db&&(this.fastupdate=!1,this.mount(t.db))}y=E.prototype;y.mount=function(t){let i=this.field;if(this.tag)for(let r=0,h;r<this.F.length;r++){h=this.F[r];var e=void 0;this.index.set(h,e=new Q({},this.reg)),i===this.field&&(i=i.slice(0)),i.push(h),e.tag=this.tag.get(h)}e=[];const n={db:t.db,type:t.type,fastupdate:t.fastupdate};for(let r=0,h,o;r<i.length;r++){n.field=o=i[r],h=this.index.get(o);const l=new t.constructor(t.id,n);l.id=t.id,e[r]=l.mount(h),h.document=!0,r?h.bypass=!0:h.store=this.store}const s=this;return this.db=Promise.all(e).then(function(){s.db=!0})};y.commit=async function(){const t=[];for(const i of this.index.values())t.push(i.commit());await Promise.all(t),this.reg.clear()};y.destroy=function(){const t=[];for(const i of this.index.values())t.push(i.destroy());return Promise.all(t)};function be(t,i){const e=new Map;let n=i.index||i.field||i;N(n)&&(n=[n]);for(let r=0,h,o;r<n.length;r++){if(h=n[r],N(h)||(o=h,h=h.field),o=lt(o)?Object.assign({},t,o):t,this.worker){var s=void 0;s=(s=o.encoder)&&s.encode?s:new ft(typeof s=="string"?Gt[s]:s||{}),s=new st(o,s),e.set(h,s)}this.worker||e.set(h,new Q(o,this.reg)),o.custom?this.B[r]=o.custom:(this.B[r]=xt(h,this.D),o.filter&&(typeof this.B[r]=="string"&&(this.B[r]=new String(this.B[r])),this.B[r].G=o.filter)),this.field[r]=h}if(this.h){t=i.store,N(t)&&(t=[t]);for(let r=0,h,o;r<t.length;r++)h=t[r],o=h.field||h,h.custom?(this.h[r]=h.custom,h.custom.O=o):(this.h[r]=xt(o,this.D),h.filter&&(typeof this.h[r]=="string"&&(this.h[r]=new String(this.h[r])),this.h[r].G=h.filter))}return e}function xt(t,i){const e=t.split(":");let n=0;for(let s=0;s<e.length;s++)t=e[s],t[t.length-1]==="]"&&(t=t.substring(0,t.length-2))&&(i[n]=!0),t&&(e[n++]=t);return n<e.length&&(e.length=n),n>1?e:e[0]}y.append=function(t,i){return this.add(t,i,!0)};y.update=function(t,i){return this.remove(t).add(t,i)};y.remove=function(t){lt(t)&&(t=ot(t,this.key));for(var i of this.index.values())i.remove(t,!0);if(this.reg.has(t)){if(this.tag&&!this.fastupdate)for(let e of this.tag.values())for(let n of e){i=n[0];const s=n[1],r=s.indexOf(t);r>-1&&(s.length>1?s.splice(r,1):e.delete(i))}this.store&&this.store.delete(t),this.reg.delete(t)}return this.cache&&this.cache.remove(t),this};y.clear=function(){const t=[];for(const i of this.index.values()){const e=i.clear();e.then&&t.push(e)}if(this.tag)for(const i of this.tag.values())i.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),t.length?Promise.all(t):this};y.contain=function(t){return this.db?this.index.get(this.field[0]).db.has(t):this.reg.has(t)};y.cleanup=function(){for(const t of this.index.values())t.cleanup();return this};y.get=function(t){return this.db?this.index.get(this.field[0]).db.enrich(t).then(function(i){return i[0]&&i[0].doc||null}):this.store.get(t)||null};y.set=function(t,i){return typeof t=="object"&&(i=t,t=ot(i,this.key)),this.store.set(t,i),this};y.searchCache=It;y.export=Me;y.import=je;Pt(E.prototype);function $t(t,i=0){let e=[],n=[];i&&(i=25e4/i*5e3|0);for(const s of t.entries())n.push(s),n.length===i&&(e.push(n),n=[]);return n.length&&e.push(n),e}function Kt(t,i){i||(i=new Map);for(let e=0,n;e<t.length;e++)n=t[e],i.set(n[0],n[1]);return i}function ee(t,i=0){let e=[],n=[];i&&(i=25e4/i*1e3|0);for(const s of t.entries())n.push([s[0],$t(s[1])[0]||[]]),n.length===i&&(e.push(n),n=[]);return n.length&&e.push(n),e}function ie(t,i){i||(i=new Map);for(let e=0,n,s;e<t.length;e++)n=t[e],s=i.get(n[0]),i.set(n[0],Kt(n[1],s));return i}function se(t){let i=[],e=[];for(const n of t.keys())e.push(n),e.length===25e4&&(i.push(e),e=[]);return e.length&&i.push(e),i}function ne(t,i){i||(i=new Set);for(let e=0;e<t.length;e++)i.add(t[e]);return i}function kt(t,i,e,n,s,r,h=0){const o=n&&n.constructor===Array;var l=o?n.shift():n;if(!l)return this.export(t,i,s,r+1);if((l=t((i?i+".":"")+(h+1)+"."+e,JSON.stringify(l)))&&l.then){const f=this;return l.then(function(){return kt.call(f,t,i,e,o?n:null,s,r,h+1)})}return kt.call(this,t,i,e,o?n:null,s,r,h+1)}function Me(t,i,e=0,n=0){if(e<this.field.length){const h=this.field[e];if((i=this.index.get(h).export(t,h,e,n=1))&&i.then){const o=this;return i.then(function(){return o.export(t,h,e+1)})}return this.export(t,h,e+1)}let s,r;switch(n){case 0:s="reg",r=se(this.reg),i=null;break;case 1:s="tag",r=this.tag&&ee(this.tag,this.reg.size),i=null;break;case 2:s="doc",r=this.store&&$t(this.store),i=null;break;default:return}return kt.call(this,t,i,s,r||null,e,n)}function je(t,i){var e=t.split(".");e[e.length-1]==="json"&&e.pop();const n=e.length>2?e[0]:"";if(e=e.length>2?e[2]:e[1],this.worker&&n)return this.index.get(n).import(t);if(i){if(typeof i=="string"&&(i=JSON.parse(i)),n)return this.index.get(n).import(e,i);switch(e){case"reg":this.fastupdate=!1,this.reg=ne(i,this.reg);for(let s=0,r;s<this.field.length;s++)r=this.index.get(this.field[s]),r.fastupdate=!1,r.reg=this.reg;if(this.worker){i=[];for(const s of this.index.values())i.push(s.import(t));return Promise.all(i)}break;case"tag":this.tag=ie(i,this.tag);break;case"doc":this.store=Kt(i,this.store)}}}function Yt(t,i){let e="";for(const n of t.entries()){t=n[0];const s=n[1];let r="";for(let h=0,o;h<s.length;h++){o=s[h]||[""];let l="";for(let f=0;f<o.length;f++)l+=(l?",":"")+(i==="string"?'"'+o[f]+'"':o[f]);l="["+l+"]",r+=(r?",":"")+l}r='["'+t+'",['+r+"]]",e+=(e?",":"")+r}return e}Q.prototype.remove=function(t,i){const e=this.reg.size&&(this.fastupdate?this.reg.get(t):this.reg.has(t));if(e){if(this.fastupdate){for(let n=0,s,r;n<e.length;n++)if((s=e[n])&&(r=s.length))if(s[r-1]===t)s.pop();else{const h=s.indexOf(t);h>=0&&s.splice(h,1)}}else ut(this.map,t),this.depth&&ut(this.ctx,t);i||this.reg.delete(t)}return this.db&&(this.commit_task.push({del:t}),this.M&&re(this)),this.cache&&this.cache.remove(t),this};function ut(t,i){let e=0;var n=typeof i>"u";if(t.constructor===Array){for(let s=0,r,h,o;s<t.length;s++)if((r=t[s])&&r.length){if(n)return 1;if(h=r.indexOf(i),h>=0){if(r.length>1)return r.splice(h,1),1;if(delete t[s],e)return 1;o=1}else{if(o)return 1;e++}}}else for(let s of t.entries())n=s[0],ut(s[1],i)?e++:t.delete(n);return e}const Se={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};Q.prototype.add=function(t,i,e,n){if(i&&(t||t===0)){if(!n&&!e&&this.reg.has(t))return this.update(t,i);n=this.depth,i=this.encoder.encode(i,!n);const f=i.length;if(f){const u=I(),c=I(),d=this.resolution;for(let p=0;p<f;p++){let m=i[this.rtl?f-1-p:p];var s=m.length;if(s&&(n||!c[m])){var r=this.score?this.score(i,m,p,null,0):dt(d,f,p),h="";switch(this.tokenize){case"tolerant":if(V(this,c,m,r,t,e),s>2){for(let g=1,a,x,w,b;g<s-1;g++)a=m.charAt(g),x=m.charAt(g+1),w=m.substring(0,g)+x,b=m.substring(g+2),h=w+a+b,V(this,c,h,r,t,e),h=w+b,V(this,c,h,r,t,e);V(this,c,m.substring(0,m.length-1),r,t,e)}break;case"full":if(s>2){for(let g=0,a;g<s;g++)for(r=s;r>g;r--){h=m.substring(g,r),a=this.rtl?s-1-g:g;var o=this.score?this.score(i,m,p,h,a):dt(d,f,p,s,a);V(this,c,h,o,t,e)}break}case"bidirectional":case"reverse":if(s>1){for(o=s-1;o>0;o--){h=m[this.rtl?s-1-o:o]+h;var l=this.score?this.score(i,m,p,h,o):dt(d,f,p,s,o);V(this,c,h,l,t,e)}h=""}case"forward":if(s>1){for(o=0;o<s;o++)h+=m[this.rtl?s-1-o:o],V(this,c,h,r,t,e);break}default:if(V(this,c,m,r,t,e),n&&f>1&&p<f-1)for(s=this.N,h=m,r=Math.min(n+1,this.rtl?p+1:f-p),o=1;o<r;o++){m=i[this.rtl?f-1-p-o:p+o],l=this.bidirectional&&m>h;const g=this.score?this.score(i,h,p,m,o-1):dt(s+(f/2>s?0:1),f,p,r-1,o-1);V(this,u,l?h:m,g,t,e,l?m:h)}}}}this.fastupdate||this.reg.add(t)}}return this.db&&(this.commit_task.push(e?{ins:t}:{del:t}),this.M&&re(this)),this};function V(t,i,e,n,s,r,h){let o,l;if(!(o=i[e])||h&&!o[h]){if(h?(i=o||(i[e]=I()),i[h]=1,l=t.ctx,(o=l.get(h))?l=o:l.set(h,l=t.keystore?new H(t.keystore):new Map)):(l=t.map,i[e]=1),(o=l.get(e))?l=o:l.set(e,l=o=[]),r){for(let f=0,u;f<o.length;f++)if((u=o[f])&&u.includes(s)){if(f<=n)return;u.splice(u.indexOf(s),1),t.fastupdate&&(i=t.reg.get(s))&&i.splice(i.indexOf(u),1);break}}if(l=l[n]||(l[n]=[]),l.push(s),l.length===2**31-1){if(i=new it(l),t.fastupdate)for(let f of t.reg.values())f.includes(l)&&(f[f.indexOf(l)]=i);o[n]=l=i}t.fastupdate&&((n=t.reg.get(s))?n.push(l):t.reg.set(s,[l]))}}function dt(t,i,e,n,s){return e&&t>1?i+(n||0)<=t?e+(s||0):(t-1)/(i+(n||0))*(e+(s||0))+1|0:0}Q.prototype.search=function(t,i,e){if(e||(i||typeof t!="object"?typeof i=="object"&&(e=i,i=0):(e=t,t="")),e&&e.cache)return e.cache=!1,t=this.searchCache(t,i,e),e.cache=!0,t;let n=[],s,r,h,o=0,l,f,u,c,d;e&&(t=e.query||t,i=e.limit||i,o=e.offset||0,r=e.context,h=e.suggest,d=(l=e.resolve)&&e.enrich,u=e.boost,c=e.resolution,f=this.db&&e.tag),typeof l>"u"&&(l=this.resolve),r=this.depth&&r!==!1;let p=this.encoder.encode(t,!r);if(s=p.length,i=i||(l?100:0),s===1)return Ft.call(this,p[0],"",i,o,l,d,f);if(s===2&&r&&!h)return Ft.call(this,p[1],p[0],i,o,l,d,f);let m=I(),g=0,a;if(r&&(a=p[0],g=1),c||c===0||(c=a?this.N:this.resolution),this.db){if(this.db.search&&(e=this.db.search(this,p,i,o,h,l,d,f),e!==!1))return e;const x=this;return(async function(){for(let w,b;g<s;g++){if((b=p[g])&&!m[b]){if(m[b]=1,w=await Ct(x,b,a,0,0,!1,!1),w=Et(w,n,h,c)){n=w;break}a&&(h&&w&&n.length||(a=b))}h&&a&&g===s-1&&!n.length&&(c=x.resolution,a="",g=-1,m=I())}return Dt(n,c,i,o,h,u,l)})()}for(let x,w;g<s;g++){if((w=p[g])&&!m[w]){if(m[w]=1,x=Ct(this,w,a,0,0,!1,!1),x=Et(x,n,h,c)){n=x;break}a&&(h&&x&&n.length||(a=w))}h&&a&&g===s-1&&!n.length&&(c=this.resolution,a="",g=-1,m=I())}return Dt(n,c,i,o,h,u,l)};function Dt(t,i,e,n,s,r,h){let o=t.length,l=t;if(o>1)l=yt(t,i,e,n,s,r,h);else if(o===1)return h?Rt.call(null,t[0],e,n):new B(t[0],this);return h?l:new B(l,this)}function Ft(t,i,e,n,s,r,h){return t=Ct(this,t,i,e,n,s,r,h),this.db?t.then(function(o){return s?o||[]:new B(o,this)}):t&&t.length?s?Rt.call(this,t,e,n):new B(t,this):s?[]:new B([],this)}function Et(t,i,e,n){let s=[];if(t&&t.length){if(t.length<=n){i.push(t);return}for(let r=0,h;r<n;r++)(h=t[r])&&(s[r]=h);if(s.length){i.push(s);return}}if(!e)return s}function Ct(t,i,e,n,s,r,h,o){let l;return e&&(l=t.bidirectional&&i>e)&&(l=e,e=i,i=l),t.db?t.db.get(i,e,n,s,r,h,o):(t=e?(t=t.ctx.get(e))&&t.get(i):t.map.get(i),t)}function Q(t,i){if(!this||this.constructor!==Q)return new Q(t);if(t){var e=N(t)?t:t.preset;e&&(t=Object.assign({},Se[e],t))}else t={};e=t.context;const n=e===!0?{depth:1}:e||{},s=N(t.encoder)?Gt[t.encoder]:t.encode||t.encoder||{};this.encoder=s.encode?s:typeof s=="object"?new ft(s):{encode:s},this.resolution=t.resolution||9,this.tokenize=e=(e=t.tokenize)&&e!=="default"&&e!=="exact"&&e||"strict",this.depth=e==="strict"&&n.depth||0,this.bidirectional=n.bidirectional!==!1,this.fastupdate=!!t.fastupdate,this.score=t.score||null,(e=t.keystore||0)&&(this.keystore=e),this.map=e?new H(e):new Map,this.ctx=e?new H(e):new Map,this.reg=i||(this.fastupdate?e?new H(e):new Map:e?new W(e):new Set),this.N=n.resolution||3,this.rtl=s.rtl||t.rtl||!1,this.cache=(e=t.cache||null)&&new G(e),this.resolve=t.resolve!==!1,(e=t.db)&&(this.db=this.mount(e)),this.M=t.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=t.priority||4}y=Q.prototype;y.mount=function(t){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),t.mount(this)};y.commit=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this)};y.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function re(t){t.commit_timer||(t.commit_timer=setTimeout(function(){t.commit_timer=null,t.db.commit(t)},1))}y.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db?(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[],this.db.clear()):this};y.append=function(t,i){return this.add(t,i,!0)};y.contain=function(t){return this.db?this.db.has(t):this.reg.has(t)};y.update=function(t,i){const e=this,n=this.remove(t);return n&&n.then?n.then(()=>e.add(t,i)):this.add(t,i)};y.cleanup=function(){return this.fastupdate?(ut(this.map),this.depth&&ut(this.ctx),this):this};y.searchCache=It;y.export=function(t,i,e=0,n=0){let s,r;switch(n){case 0:s="reg",r=se(this.reg);break;case 1:s="cfg",r=null;break;case 2:s="map",r=$t(this.map,this.reg.size);break;case 3:s="ctx",r=ee(this.ctx,this.reg.size);break;default:return}return kt.call(this,t,i,s,r,e,n)};y.import=function(t,i){if(i)switch(typeof i=="string"&&(i=JSON.parse(i)),t=t.split("."),t[t.length-1]==="json"&&t.pop(),t.length===3&&t.shift(),t=t.length>1?t[1]:t[0],t){case"reg":this.fastupdate=!1,this.reg=ne(i,this.reg);break;case"map":this.map=Kt(i,this.map);break;case"ctx":this.ctx=ie(i,this.ctx)}};y.serialize=function(t=!0){let i="",e="",n="";if(this.reg.size){let r;for(var s of this.reg.keys())r||(r=typeof s),i+=(i?",":"")+(r==="string"?'"'+s+'"':s);i="index.reg=new Set(["+i+"]);",e=Yt(this.map,r),e="index.map=new Map(["+e+"]);";for(const h of this.ctx.entries()){s=h[0];let o=Yt(h[1],r);o="new Map(["+o+"])",o='["'+s+'",'+o+"]",n+=(n?",":"")+o}n="index.ctx=new Map(["+n+"]);"}return t?"function inject(index){"+i+e+n+"}":i+e+n};Pt(Q.prototype);const he=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),vt=["map","ctx","tag","reg","cfg"],D=I();function Ot(t,i={}){if(!this||this.constructor!==Ot)return new Ot(t,i);typeof t=="object"&&(i=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=i.field?i.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=i.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}y=Ot.prototype;y.mount=function(t){return t.index?t.mount(this):(t.db=this,this.open())};y.open=function(){if(this.db)return this.db;let t=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist(),D[t.id]||(D[t.id]=[]),D[t.id].push(t.field);const i=he.open(t.id,1);return i.onupgradeneeded=function(){const e=t.db=this.result;for(let n=0,s;n<vt.length;n++){s=vt[n];for(let r=0,h;r<D[t.id].length;r++)h=D[t.id][r],e.objectStoreNames.contains(s+(s!=="reg"&&h?":"+h:""))||e.createObjectStore(s+(s!=="reg"&&h?":"+h:""))}},t.db=X(i,function(e){t.db=e,t.db.onversionchange=function(){t.close()}})};y.close=function(){this.db&&this.db.close(),this.db=null};y.destroy=function(){const t=he.deleteDatabase(this.id);return X(t)};y.clear=function(){const t=[];for(let e=0,n;e<vt.length;e++){n=vt[e];for(let s=0,r;s<D[this.id].length;s++)r=D[this.id][s],t.push(n+(n!=="reg"&&r?":"+r:""))}const i=this.db.transaction(t,"readwrite");for(let e=0;e<t.length;e++)i.objectStore(t[e]).clear();return X(i)};y.get=function(t,i,e=0,n=0,s=!0,r=!1){t=this.db.transaction((i?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((i?"ctx":"map")+(this.field?":"+this.field:"")).get(i?i+":"+t:t);const h=this;return X(t).then(function(o){let l=[];if(!o||!o.length)return l;if(s){if(!e&&!n&&o.length===1)return o[0];for(let f=0,u;f<o.length;f++)if((u=o[f])&&u.length){if(n>=u.length){n-=u.length;continue}const c=e?n+Math.min(u.length-n,e):u.length;for(let d=n;d<c;d++)l.push(u[d]);if(n=0,l.length===e)break}return r?h.enrich(l):l}return o})};y.tag=function(t,i=0,e=0,n=!1){t=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(t);const s=this;return X(t).then(function(r){return!r||!r.length||e>=r.length?[]:!i&&!e?r:(r=r.slice(e,e+i),n?s.enrich(r):r)})};y.enrich=function(t){typeof t!="object"&&(t=[t]);const i=this.db.transaction("reg","readonly").objectStore("reg"),e=[];for(let n=0;n<t.length;n++)e[n]=X(i.get(t[n]));return Promise.all(e).then(function(n){for(let s=0;s<n.length;s++)n[s]={id:t[s],doc:n[s]?JSON.parse(n[s]):null};return n})};y.has=function(t){return t=this.db.transaction("reg","readonly").objectStore("reg").getKey(t),X(t).then(function(i){return!!i})};y.search=null;y.info=function(){};y.transaction=function(t,i,e){t+=t!=="reg"&&this.field?":"+this.field:"";let n=this.h[t+":"+i];if(n)return e.call(this,n);let s=this.db.transaction(t,i);this.h[t+":"+i]=n=s.objectStore(t);const r=e.call(this,n);return this.h[t+":"+i]=null,X(s).finally(function(){return r})};y.commit=async function(t){let i=t.commit_task,e=[];t.commit_task=[];for(let n=0,s;n<i.length;n++)s=i[n],s.del&&e.push(s.del);e.length&&await this.remove(e),t.reg.size&&(await this.transaction("map","readwrite",function(n){for(const s of t.map){const r=s[0],h=s[1];h.length&&(n.get(r).onsuccess=function(){let o=this.result;var l;if(o&&o.length){const f=Math.max(o.length,h.length);for(let u=0,c,d;u<f;u++)if((d=h[u])&&d.length){if((c=o[u])&&c.length)for(l=0;l<d.length;l++)c.push(d[l]);else o[u]=d;l=1}}else o=h,l=1;l&&n.put(o,r)})}}),await this.transaction("ctx","readwrite",function(n){for(const s of t.ctx){const r=s[0],h=s[1];for(const o of h){const l=o[0],f=o[1];f.length&&(n.get(r+":"+l).onsuccess=function(){let u=this.result;var c;if(u&&u.length){const d=Math.max(u.length,f.length);for(let p=0,m,g;p<d;p++)if((g=f[p])&&g.length){if((m=u[p])&&m.length)for(c=0;c<g.length;c++)m.push(g[c]);else u[p]=g;c=1}}else u=f,c=1;c&&n.put(u,r+":"+l)})}}}),t.store?await this.transaction("reg","readwrite",function(n){for(const s of t.store){const r=s[0],h=s[1];n.put(typeof h=="object"?JSON.stringify(h):1,r)}}):t.bypass||await this.transaction("reg","readwrite",function(n){for(const s of t.reg.keys())n.put(1,s)}),t.tag&&await this.transaction("tag","readwrite",function(n){for(const s of t.tag){const r=s[0],h=s[1];h.length&&(n.get(r).onsuccess=function(){let o=this.result;o=o&&o.length?o.concat(h):h,n.put(o,r)})}}),t.map.clear(),t.ctx.clear(),t.tag&&t.tag.clear(),t.store&&t.store.clear(),t.document||t.reg.clear())};function _t(t,i,e){const n=t.value;let s,r=0;for(let h=0,o;h<n.length;h++){if(o=e?n:n[h]){for(let l=0,f,u;l<i.length;l++)if(u=i[l],f=o.indexOf(u),f>=0)if(s=1,o.length>1)o.splice(f,1);else{n[h]=[];break}r+=o.length}if(e)break}r?s&&t.update(n):t.delete(),t.continue()}y.remove=function(t){return typeof t!="object"&&(t=[t]),Promise.all([this.transaction("map","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&_t(e,t)}}),this.transaction("ctx","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&_t(e,t)}}),this.transaction("tag","readwrite",function(i){i.openCursor().onsuccess=function(){const e=this.result;e&&_t(e,t,!0)}}),this.transaction("reg","readwrite",function(i){for(let e=0;e<t.length;e++)i.delete(t[e])})])};function X(t,i){return new Promise((e,n)=>{t.onsuccess=t.oncomplete=function(){i&&i(this.result),i=null,e(this.result)},t.onerror=t.onblocked=n,t=null})}const _e={Document:E};class Ae{index;posts;constructor(){this.posts=oe.routes,this.index=new _e.Document({document:{id:"slug",index:["title","description","tags","prefix"],store:!1},tokenize:"full",context:!0,cache:!0,resolution:9}),this.initializeIndex()}initializeIndex(){this.posts.forEach(i=>{this.index.add({slug:i.slug,title:i.frontMatter.title,description:i.frontMatter.description||"",tags:i.frontMatter.tags||[],prefix:i.prefix})})}calculateScores(i){const e=new Map,n={title:10,prefix:5,tags:5,description:2};return i.forEach(s=>{const r=n[s.field]||1;s.result.forEach((h,o)=>{const l=r*10/(o+1);e.set(h,(e.get(h)||0)+l)})}),e}search(i="",e=[],n=[]){let s=this.posts,r=new Map;if(i){const h=i.trim(),o=h.split(/\s+/).filter(l=>l.length>0);if(o.length>1){const l=o.map(c=>{const d=this.index.search(c,{limit:100,bool:"or"});return this.calculateScores(d)}),f=l[0],u=new Set(f.keys());for(let c=1;c<l.length;c++){const d=new Set(l[c].keys());for(const p of u)d.has(p)||u.delete(p)}u.forEach(c=>{let d=0;l.forEach(p=>{d+=p.get(c)||0}),r.set(c,d)})}else{const l=this.index.search(h,{limit:100,bool:"or"});r=this.calculateScores(l)}s=this.posts.filter(l=>r.has(l.slug)).map(l=>({...l,score:r.get(l.slug)})).sort((l,f)=>{const u=l.score||0;return(f.score||0)-u})}return e.length>0&&(s=s.filter(h=>{const o=h.frontMatter.tags||[];return e.every(l=>o.includes(l))})),n.length>0&&(s=s.filter(h=>{const o=h.prefix;return!Array.isArray(o)||o.length<n.length?!1:Array.from({length:o.length-n.length+1},(l,f)=>f).some(l=>n.every((f,u)=>f===o[l+u]))})),s}getAllTags(){const i=new Set;return this.posts.forEach(e=>{e.frontMatter.tags?.forEach(n=>i.add(n))}),Array.from(i).sort()}getPosts(){return this.posts}}const Ce=new Ae;export{Ce as s};
